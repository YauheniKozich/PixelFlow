# Core - Ядро системы

Главная папка с основными компонентами ImageParticleGenerator.

## Файлы

### GenerationCoordinator.swift
**Главный координатор системы**

- Управляет всем процессом генерации частиц
- Координирует работу конвейера и компонентов
- Предоставляет публичный API для пользователей
- Обрабатывает асинхронные операции, кэширование и отмену
- Отслеживает прогресс и ошибки

**Ключевые методы:**
- `generateParticles()` - основная асинхронная генерация
- `cancelGeneration()` - отмена процесса
- `clearCache()` - очистка кэша

### GenerationPipeline.swift
**Конвейер выполнения этапов генерации**

- Реализует последовательность стадий: анализ, сэмплинг, сборка, кэширование
- Поддерживает различные стратегии генерации
- Обеспечивает изоляцию и тестируемость компонентов

**Ключевые методы:**
- `execute()` - выполнение конвейера с прогрессом

### GenerationContext.swift
**Контекст выполнения генерации**

- Хранит промежуточные данные между стадиями
- Управляет состоянием генерации
- Обеспечивает потокобезопасность

### ImageParticleGeneratorToParticleSystemAdapter.swift
**Адаптер для интеграции с ParticleSystem**

- Преобразует результаты генерации для системы частиц
- Обеспечивает совместимость интерфейсов

### GeneratorProtocol.swift
**Базовые протоколы генератора**

- `ImageParticleGeneratorProtocol` - основной интерфейс
- Определяет контракт для всех генераторов частиц из изображений
- Обеспечивает совместимость и расширяемость

### Protocols.swift
**Общие протоколы компонентов**

- `ImageAnalyzer` - протокол для анализа изображений
- `PixelSampler` - протокол для сэмплинга пикселей
- `ParticleAssembler` - протокол для сборки частиц
- `CacheManager` - протокол для кэширования
- `ParticleGeneratorDelegate` - обратные вызовы

## Взаимодействие

```
Пользователь
    ↓
GenerationCoordinator (координатор)
    ↓
GenerationPipeline (конвейер)
    ↓
├── ImageAnalyzer (анализ)
├── PixelSampler (сэмплинг)
├── ParticleAssembler (сборка)
└── CacheManager (кэширование)
```

**Архитектура:**
- **Coordinator**: Управление жизненным циклом, API
- **Pipeline**: Логика последовательности стадий
- **Context**: Обмен данными между стадиями
- **Adapter**: Интеграция с внешними системами