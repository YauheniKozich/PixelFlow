# ImageParticleGenerator - –£–ú–ù–´–ô –ì–ï–ù–ï–†–ê–¢–û–† –ß–ê–°–¢–ò–¶

–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–∞—Å—Ç–∏—Ü –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

## üéØ –û–ë–ó–û–†

`ImageParticleGenerator` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –º–∞—Å—Å–∏–≤—ã —á–∞—Å—Ç–∏—Ü —Å —É—á–µ—Ç–æ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–π –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø–∏–∫—Å–µ–ª–µ–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–∞—Å—Ç–∏—Ü.

## üìÅ –°–¢–†–£–ö–¢–£–†–ê

```
Engine/Generators/ImageParticleGenerator/
‚îú‚îÄ‚îÄ Core/ImageParticleGenerator.swift    # üéØ –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –∏ API
‚îú‚îÄ‚îÄ Analysis/ImageAnalysis.swift         # üìä –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îú‚îÄ‚îÄ Sampling/PixelSampling.swift         # üé® –£–º–Ω—ã–π —Å—ç–º–ø–ª–∏–Ω–≥ –ø–∏–∫—Å–µ–ª–µ–π
‚îú‚îÄ‚îÄ Assembly/ParticleAssembler.swift     # üèóÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü
‚îî‚îÄ‚îÄ README.md                            # üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üß† –ò–ù–¢–ï–õ–õ–ï–ö–¢ –ì–ï–ù–ï–†–ê–¶–ò–ò

### 1. üìä –ê–ù–ê–õ–ò–ó –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø (`ImageAnalysis.swift`)
- **–¶–≤–µ—Ç–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏**: —Å—Ä–µ–¥–Ω–∏–π —Ü–≤–µ—Ç, –∫–æ–Ω—Ç—Ä–∞—Å—Ç, —è—Ä–∫–æ—Å—Ç—å
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –ø–∏–∫—Å–µ–ª–µ–π, —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–µ —Ü–≤–µ—Ç–∞
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –¥–∞–Ω–Ω—ã–µ –¥–ª—è —É–º–Ω–æ–≥–æ —Å—ç–º–ø–ª–∏–Ω–≥–∞

### 2. üéØ –£–ú–ù–´–ô –°–≠–ú–ü–õ–ò–ù–ì (`PixelSampling.swift`)
- **–í–∞–∂–Ω–æ—Å—Ç—å –ø–∏–∫—Å–µ–ª–µ–π**: –∫–æ–Ω—Ç—Ä–∞—Å—Ç, –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å, —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
- **–í–∑–≤–µ—à–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä**: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–π —Å—ç–º–ø–ª–∏–Ω–≥ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å**: –±–æ–ª—å—à–µ —á–∞—Å—Ç–∏—Ü –≤ —Å–ª–æ–∂–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö

### 3. üèóÔ∏è –ì–ï–ù–ï–†–ê–¶–ò–Ø –ß–ê–°–¢–ò–¶ (`ParticleGeneration.swift`)
- **Target –ø–æ–∑–∏—Ü–∏–∏**: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ø–∏–∫—Å–µ–ª—è–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **–¶–≤–µ—Ç–∞**: –Ω–∞—Å–ª–µ–¥—É—é—Ç —Ü–≤–µ—Ç–∞ –ø–∏–∫—Å–µ–ª–µ–π
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ø–æ–¥ —ç–∫—Ä–∞–Ω —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

## üé® –ê–õ–ì–û–†–ò–¢–ú –í–ê–ñ–ù–û–°–¢–ò –ü–ò–ö–°–ï–õ–ï–ô

```swift
// –ê–ª–≥–æ—Ä–∏—Ç–º –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø–∏–∫—Å–µ–ª–µ–π (PixelSampling.swift)
importance = (localContrast √ó 0.4) + (saturation √ó 0.3) + (minDistanceToDominant √ó 0.3)
```

- **–õ–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç** (40%): —Ä–∞–∑–Ω–∏—Ü–∞ —Å —Å–æ—Å–µ–¥–Ω–∏–º–∏ –ø–∏–∫—Å–µ–ª—è–º–∏ (3x3 –æ–±–ª–∞—Å—Ç—å)
- **–ù–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å** (30%): –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Å–µ—Ä–æ–≥–æ —Ü–≤–µ—Ç–∞
- **–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏—Ö** (30%): —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Ü–≤–µ—Ç–∞ —Å—Ä–µ–¥–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö (—á–µ–º –¥–∞–ª—å—à–µ, —Ç–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–µ–µ)

## üîÑ –ü–†–û–¶–ï–°–° –ì–ï–ù–ï–†–ê–¶–ò–ò

1. **–ê–Ω–∞–ª–∏–∑** ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí `ImageAnalysis`
2. **–°—ç–º–ø–ª–∏–Ω–≥** ‚Üí –í–∞–∂–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ ‚Üí `Sample[]`
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è** ‚Üí –ß–∞—Å—Ç–∏—Ü—ã ‚Üí `Particle[]`
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Üí –ü–æ–¥ —ç–∫—Ä–∞–Ω ‚Üí –ì–æ—Ç–æ–≤–æ!

## üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê

–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
```
[sampleImage] üìä Importance stats:
  - Average: 0.234
  - Max: 0.891
  - Min: 0.012
  - Range: 0.879
[sampleImage] ‚úÖ Final samples: 10,000 (from 45,230 candidates)
```

## üéØ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê

- ‚úÖ **–£–º–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: —á–∞—Å—Ç–∏—Ü—ã —Ç–∞–º, –≥–¥–µ –≤–∞–∂–Ω–µ–µ
- ‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ —Å–±–æ—Ä–∫–∏**: –∫—Ä–∞—è –∏ –¥–µ—Ç–∞–ª–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –ª–µ–≥–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

## üîß –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï

```swift
let generator = try ImageParticleGenerator(image: image, particleCount: 10000)
let particles = generator.generateParticles() // ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ParticleSystem
// –ì–æ—Ç–æ–≤–æ! 10,000 —É–º–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
```

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ß–∞—Å—Ç–∏—Ü—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º –∏ —Ä–µ–∞–ª–∏–∑–º–æ–º! üé®‚ú®
